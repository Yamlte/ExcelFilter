## ExcelFiller: Автоматическое заполнение шаблонов Excel с помощью Node.js

**ExcelFiller** - это инструмент для Node.js, который автоматизирует процесс заполнения шаблонов Excel данными. Он позволяет создавать настраиваемые Excel-файлы, такие как счета, отчеты и персонализированные документы, без ручного ввода информации. Просто задайте шаблон, укажите откуда брать данные, и ExcelFiller сделает всё остальное!

**Что ExcelFiller умеет:**

*   Заполняет шаблоны Excel: Берет ваш шаблон Excel и вставляет в него нужную информацию.
*   Работает с разными данными: Поддерживает числа, текст (строки), даты и другие типы данных.
*   Соединяет данные с нужными местами в Excel: Вы сами указываете, какие данные должны попасть в какие ячейки или диапазоны ячеек.
*   Заполняет пустоты: Если в шаблоне остались пустые места (ячейки), можно автоматически заполнить их прочерками ("-") или другими значениями, чтобы отчет выглядел аккуратно.
*   Поддерживает форматы: Позволяет настраивать форматы данных, например, чтобы число отображалось с двумя знаками после запятой, или дата показывалась в определенном виде.
*   Легко встраивается в ваши проекты: Просто добавьте ExcelFiller в свой проект Node.js, и он будет автоматически генерировать Excel-файлы, когда это нужно.
*   Гибко настраивается: Инструмент можно настроить под разные задачи и потребности.

**Кому это нужно?**

*   Бухгалтерам, менеджерам по продажам, маркетологам и всем, кто работает с Excel.

## Руководство пользователя ExcelFiller: Быстрый старт

Это простое руководство поможет вам начать использовать ExcelFiller.

**1. Подготовка:**

*   Node.js: Установите Node.js (версия 14 или выше) с [https://nodejs.org/](https://nodejs.org/).
*   Текстовый редактор: Установите любой текстовый редактор (VS Code, Sublime Text и т.д.)
*   Ваш шаблон Excel: Создайте Excel-файл, который будет использоваться в качестве шаблона. Разметьте в нем ячейки, куда будут вставляться данные.
*   Файл с данными (пример): ExcelFiller требует файла конфигурации, описывающего источник данных, шаблон и т.д. Для простоты, можно использовать один и тот же файл `ExcelFiller.js` и модифицировать функцию `main()`.

**2. Установка ExcelFiller (в терминале/командной строке):**

*   Перейдите в директорию с файлом `ExcelFiller.js` (или клонируйте репозиторий, если он размещен на GitHub).
*   Выполните команду `npm install exceljs`. Это установит библиотеку `exceljs`, которая нужна для работы с Excel-файлами.

**3. Настройка:**

*   Откройте файл `ExcelFiller.js` в текстовом редакторе.
*   Найдите функцию `async function main() {`. Внутри этой функции нужно настроить несколько переменных:
    *   `templatePath`: Путь к вашему Excel-шаблону (например, `'./template.xlsx'`).
    *   `outputPath`: Путь, куда сохранить заполненный файл (например, `'./output.xlsx'`).
    *   `data`: Массив с данными, которые вы хотите вставить в шаблон.
    *   `cellRanges`: Объект, который описывает, какие данные в какую ячейку вставлять. Он состоит из пар "ключ: значение", где ключ это индекс элемента из массива `data`, а значение - объект с настройками вставки:
        *   `type: 'cell'` - вставка в одну ячейку, `address` - адрес ячейки (например, `A1`).
        *   `type: 'cells'` - посимвольная вставка в несколько ячеек, `addresses` - массив адресов ячеек (например, `['A1', 'B1', 'C1']`).
        *   `type: 'range'` - посимвольная вставка в диапазон, `start` - начальная ячейка диапазона, `end` - конечная ячейка диапазона.
*   Пример настройки:

    ```javascript
    async function main() {
        const templatePath = './template.xlsx';
        const outputPath = './output.xlsx';
        const data = ['Иван', 'Иванов', 30];

        const cellRanges = {
            0: { type: 'cell', address: 'A1' }, // Имя в ячейку A1
            1: { type: 'cell', address: 'B1' }, // Фамилия в ячейку B1
            2: { type: 'cell', address: 'C1' }  // Возраст в ячейку C1
        };

        // ... остальной код ...
    }
    ```

**4. Запуск:**

*   В терминале/командной строке выполните команду `node ExcelFiller.js`.

**5. Результат:**

*   После выполнения скрипта в указанной папке (`outputPath`) появится новый Excel-файл с заполненными данными.

**Важно:**

*   Убедитесь, что все пути к файлам указаны правильно.
*   Проверьте, что типы данных в массиве `data` соответствуют ожидаемым.
*   Если что-то не работает, посмотрите в консоль - там могут быть сообщения об ошибках.
*   Не используйте имена файлов, начинающиеся с `~$`.

**Советы:**

*   Для работы с базами данных или другими источниками данных, вам понадобится добавить код для получения данных из этих источников и записи их в массив `data`.
*   Изучите документацию библиотеки `exceljs` для более продвинутых возможностей, таких как форматирование ячеек, работа с формулами и т.д.

Этот скрипт позволяет автоматизировать создание однотипных Excel-файлов. Настройте его под свои нужды и экономьте время!
